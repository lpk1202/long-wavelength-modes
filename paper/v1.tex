\documentclass[prd,amsmath,amssymb,floatfix,superscriptaddress,nofootinbib,twocolumn]{revtex4-1}

\def\be{\begin{equation}}
\def\ee{\end{equation}}
\def\bea{\begin{eqnarray}}
\def\eea{\end{eqnarray}}
\newcommand{\vs}{\nonumber\\}
\newcommand{\Var}{\rm Var}
\newcommand{\vk}{\vec{k}}
\newcommand{\ec}[1]{Eq.~(\ref{eq:#1})}
\newcommand{\eec}[2]{Eqs.~(\ref{eq:#1}) and (\ref{eq:#2})}
\newcommand{\Ec}[1]{(\ref{eq:#1})}
\newcommand{\eql}[1]{\label{eq:#1}}
\newcommand{\rf}[1]{\ref{fig:#1}}
\newcommand{\sfig}[2]{
\includegraphics[width=#2]{../plots/#1}
        }
\newcommand{\sfigg}[2]{
\includegraphics[width=0.88\paperwidth]{../plots/#1}
        }
\newcommand{\sfigr}[2]{
\includegraphics[angle=270,origin=c,width=#2]{#1}
        }
\newcommand{\sfigra}[2]{
\includegraphics[angle=90,origin=c,width=#2]{#1}
        }
\newcommand{\Sfig}[2]{
   \begin{figure}[thbp]
   \begin{center}
    \sfig{../plots/#1.pdf}{\columnwidth}
    \caption{{\small #2}}
    \label{fig:#1}
     \end{center}
   \end{figure}
}
\newcommand{\Sfigg}[2]{
   \begin{figure*}[thbp]
    \sfigg{../plots/#1.pdf}{\columnwidth}
    \caption{{\small #2}}
    \label{fig:#1}
   \end{figure*}
}
\newcommand{\Spng}[2]{
   \begin{figure}[thbp]
   \begin{center}
    \sfigg{../plots/#1.png}{\columnwidth}
    \caption{{\small #2}}
    \label{fig:#1}
     \end{center}
   \end{figure}
}

\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{simplewick}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{color}
\usepackage{enumitem}
\usepackage[linktocpage=true]{hyperref} 
\hypersetup{
    colorlinks=true,       
    linkcolor=red,         
    citecolor=blue,        
    filecolor=magenta,      
    urlcolor=blue           
}
\usepackage[all]{hypcap} 
\definecolor{darkgreen}{cmyk}{0.85,0.1,1.00,0} 
\newcommand{\scott}[1]{{\color{darkgreen} #1}}
\newcommand{\peikai}[1]{{\color{blue} #1}}
\newcommand{\prvs}[1]{{\color{magenta} #1}}
\newcommand{\AL}[1]{{\color{magenta} AL: #1}}
\newcommand{\MR}[1]{{\color{blue} MR: #1}}
\newcommand{\nl}{\\ \indent}
\begin{document}
\title{Large Scale Structure Reconstruction with Short-Wavelength Modes}
\author{\large Peikai Li}
\affiliation{Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA}
\author{\large Scott Dodelson}
\affiliation{Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA}
\author{\large Rupert A. C. Croft}
\affiliation{Department of Physics, Carnegie Mellon University, Pittsburgh, PA 15213, USA}
\affiliation{McWilliams Center for Cosmology, Carnegie Mellon University, Pittsburgh, PA 15213, USA}

\date{\today}
\begin{abstract}
\noindent Large scale density modes cannot be measured directly through surveys but we can study them by measuring perturbations on small scales. Cosmological perturbation theory predicts that second-order density inhomogeneities are a convolution of a short- and a long-wavelength mode. This arises physically because small structure structure varies depending on the large scale environment in which it resides. This will induce small scale clustering in real space and an off-diagonal term in two-point statistics in Fourier space. Therefore we can build a quadratic estimator for the large scale field. We demonstrate that this quadratic estimator works amazingly well for our N-body simulation test.

\end{abstract}
\maketitle
\section{Introduction}
Measuring the distribution of structures on large scales has been one of the main goals of recent surveys despite it is hard to accomplish directly. To tackle this problem, relations between long- and short-wavelength modes have been frequently discussed recent years \cite{Baldauf:2011fer}\cite{Barreira:2017res}. Method of using small scale position-dependent power spectrum to compute squeezed-limit bispectrum also indicates that we can use small scale perturbation to infer large scale information to some extent \cite{Chiang:2014pos}\cite{Chiang:2015poss}. In order to achieve this goal, we develop in this work a generalized approach of building a quadratic estimator to measure long-wavelength modes indirectly. \\
Starting from second-order standard perturbation theory (SPT) \cite{Goroff:1986sts}\cite{Makino:1992fs}\cite{Jain:1994sop}, we can identify second-order perturbation of a short-wavelength mode as a convolution of a short- and a long-wavelength mode. This can be further related to cosmic microwave background (CMB) lensing case \cite{Hu:2002mr}, where CMB temperature field has a second-order correction due to gravitational field along line of sight. Similarly in this case the short-wavelength mode's nonlinear terms are related to the large scale environment it belongs to.
\\
During CMB lensing quadratic estimator's construction, small scale two-point correlation of CMB temperature modes has off-diagonal terms due to large scale perturbations caused by gravitational lensing. The same procedure applies in our case as well - off-diagonal terms of small scale correlations are no-longer zero due to large scale modes. Thus we can create a quadratic estimator for long-wavelength modes using the exact same formalism. \\
We begin with a brief review of SPT up to second-order in section \ref{sec1}. Then we build the quadratic estimator and compute the detectability of the estimator in section \ref{sec2}. In section \ref{sec3} we present a concise study of the estimator with data from N-body simulation. Finally we conclude this work and discuss future work related to this in section \ref{sec4}. We use flat $\Lambda$CDM model with Planck Collaboration XVI (2014) \cite{Planck:2014cos} cosmological parameters in this work (same as parameters of the N-body simulation).

\section{Standard Perturbation Theory}\label{sec1}
In this section we review the SPT approach which describes small scale nonlinearity. Then we compute the off-diagonal term of two short-wavelength modes in the squeezed limit. This off-diagonal term proportional to a long-wavelength mode will be the key factor of constructing the quadratic estimator. \\
Starting from a perfect pressureless fluid, the nonrelativistic cosmological fluid equations are continuity, Euler and Poisson equations:
\bea
\frac{\partial \delta(\vec{x},\tau)}{\partial \tau} &+&\vec{\nabla}\times [(1+\delta(\vec{x},\tau))\vec{v}(\vec{x},\tau)] =0\eql{fluid1} \\
(\frac{\partial}{\partial \tau} +\vec{v}(\vec{x},\tau)&\times&\vec{\nabla})\vec{v}(\vec{x},\tau)=-\frac{da}{d\tau}\frac{\vec{v}(\vec{x},\tau)}{a}-\vec{\nabla}\Phi \eql{eulereq}\\
&&\nabla^2 \Phi = 4\pi G a^2 \bar{\rho}_{\rm m} \delta(\vec{x},\tau) \eql{fluid3}
\eea
these equations fully determine the time evolution of the local density contrast $\delta$ and the peculiar velocity field $\vec{v}=d\vec{x}/d\tau$.\\
We can solve these equations in Fourier space with perturbative expansion \cite{Bernardeau:2002rev}:
\bea
{\delta}(\vk,\tau) &=&\sum_{n=1}^{\infty} {\delta}^{(n)}(\vk,\tau)=\sum_{n=1}^{\infty}D_1^{n}(\tau)\delta_{n}(\vk)  \eql{pert1}\\
{\theta}(\vk,\tau)&=&\sum_{n=1}^{\infty}{\theta}^{(n)}(\vk,\tau) \vs
&=&-\frac{d\,\ln D_1(\tau)}{d\tau}\sum_{n=1}^{\infty}D_1^{n}(\tau)\theta_{n}(\vk) \eql{pert2}
\eea
where $D_1$ is the linear growth factor. The first order term ${\delta}^{(1)}$ corresponds to linear evolution. The inear power spectrum is given by this first order term via:
\be 
\langle {\delta^{(1)}}(\vk,\tau){\delta^{(1)}}(\vk',\tau) \rangle =(2\pi)^3 \delta_{\rm D}(\vk+\vk')P_{\rm lin}(k,\tau) \eql{lin}
\ee 
Plugging the perturbative series \ec{pert1} and \ec{pert2} into the fluid equations \ec{fluid1}-\ec{fluid3} after Fourier transform, we can solve second-order density contrast and the result is given by:
\be
{\delta}^{(2)}(\vk,\tau)=\int \frac{d^{3}\vk_{1}}{(2\pi)^3} F_2(\vk_1,\vk-\vk_1){\delta}^{(1)}(\vk_1,\tau) {\delta}^{(1)}(\vk-\vk_1,\tau) \eql{sorder} 
\ee
with 
\be
F_{2}(\vk_1,\vk_2)=\frac{5}{7}+\frac{2}{7}\frac{(\vk_1\cdot \vk_2)^2}{k_1^2 k_2^2}+\frac{\vk_1\cdot \vk_2}{2k_1k_2}(\frac{k_1}{k_2}+\frac{k_2}{k_1})\eql{f2}
\ee
Notice \ec{f2} is derived in Einstein-de Sitter universe. Nonetheless when we actually do relative calculation in $\Lambda$CDM universe, the difference is negligible \cite{Takahashi:2008to} thus we still use the expression from \ec{f2} throughout the whole work.\\
Compute the two-point correlations of two short-wavelength modes $\vk_s$ and $\vk_s'$, in the squeezed limit $\vk_l=\vk_s+\vk_s'$ up to second-order where $\vk_l$ corresponds to a long-wavelength mode we have ($\tau$ is fixed at today):
\bea 
&& \langle {\delta}(\vec{k}_s){\delta}(\vec{k}_s') \rangle|_{\vk_s+\vk_s'=\vk_l}
\vs 
&=&  \langle {\delta}^{(1)}(\vec{k}_s){\delta}^{(2)}(\vec{k}_s') \rangle+\langle {\delta}^{(2)}(\vec{k}_s){\delta}^{(1)}(\vec{k}_s') \rangle
\eea 
Substituting \ec{sorder} into the first bracket we get:
\bea 
\langle {\delta}^{(1)}(\vec{k}_s){\delta}^{(2)}(\vec{k}_s') \rangle =  \int \frac{d^3\vec{k}}{(2\pi)^3} F_2 (\vec{k},\vec{k}_s'-\vec{k})\vs
\times \langle {\delta}^{(1)}(\vec{k}_s){\delta}^{(1)}(\vec{k}_s'-\vec{k}){\delta}^{(1)}(\vec{k}) \rangle \eql{integral}
\eea 
We claim that generally correlation function of three Gaussian fields is nonzero under following consideration: if a three-point correlation function consists of two short-wavelength modes and one long-wavelength mode, we can do the following contraction:
\be 
\langle
\contraction{}{{\delta}}{{\delta^{(1)}\;\;\;\;}(}{}
{\delta^{(1)}}(\vk_{1}) {\delta^{(1)}}(\vk_{2}){\delta^{(1)}}(\vk_3) 
\rangle
=\langle {\delta^{(1)}}(\vk_{1}) {\delta^{(1)}}(\vk_{2}) \rangle {\delta^{(1)}}(\vk_3)  \eql{contraction}
\ee 
$\vk_1$ and $\vk_2$ corresponds to two arbitrary short modes and $\vk_3$ arbitrary long mode. The above equation is true since in a real life survey, we can only measure this long-wavelength mode very limited times. Thus it won't have any statistical property and we can safely extract the long-wavelength mode out of the bracket.\\
We can do this contraction twice in this integral \ec{integral}. One occurs when $|\vk| \ll |\vk_s|,\, |\vk_s'-\vk|$, we can extract ${\delta}^{(1)}(\vk)$ out; the other one occurs when $|\vk_s'-\vk| \ll |\vk|,\,|\vk_s|$.\\
Use \ec{lin} the integral in \ec{integral} can be evaluated as:
\bea 
&&\int \frac{d^3\vec{k}}{(2\pi)^3} F_2 (\vec{k},\vec{k}_s'-\vec{k})\langle {\delta}^{(1)}(\vec{k}_s){\delta}^{(1)}(\vec{k}_s'-\vec{k}){\delta}^{(1)}(\vec{k}) \rangle \vs
&=&\int d^3\vk F_2(\vec{k},\vec{k}_s'-\vec{k}) \delta_{\rm D}(\vk_s+\vk_s'-\vk)P_{\rm 
lin}(k_s){\delta}^{(1)}(\vec{k}) \vs
&+&\int d^3\vk F_2(\vec{k},\vec{k}_s'-\vec{k}) \delta_{\rm D}(\vk_s+\vk)P_{\rm 
lin}(k_s){\delta}^{(1)}(\vk_s'-\vk) \vs
&=&2F_2(-\vk_s,\vk_s+\vk_s')P_{\rm lin}(k_s){\delta}^{(1)}(\vk_s+\vk_s')
\eea 
where we use the fact that $F_2$ is symmetric function. Finally we have:
\be 
\langle {\delta}(\vec{k}_s){\delta}(\vec{k}_s') \rangle =f(\vec{k}_s,\vec{k}_s'){\delta}^{(1)}(\vec{k}_l) \eql{2pt}
\ee 
with
\bea
f(\vec{k}_s,\vec{k}_s')&=&2F_2(-\vec{k}_s,\vec{k}_s+\vec{k}_s')P_{\rm lin}(k_s)\vs
&+&2F_2(-\vec{k}_s',\vec{k}_s+\vec{k}_s')P_{\rm lin}(k_s')       
\eea 
\ec{2pt} suggests that we can estimate long-wavelength modes using short-wavelength modes. Also notice that second-order SPT gets less accurate higher in the nonlinear regime and will produce a bias of our quadratic estimator, we can see this effect in \ref{sec3}.


%Taking the divergence of \ec{eulereq} we can eliminate the gravitational potential $\Phi$ in Fourier space and get evolution equations for $\delta(\vk,\tau)$ and $\theta(\vk,\tau)$ in Fourier space:
%\bea 
%\frac{\partial{\delta}}{\partial\tau} + {\theta} &=& -\int \frac{d^{3}\vk_{1}}{(2\pi)^3} \int \frac{d^{3}\vk_{2}}{(2\pi)^3} (2\pi)^3 \delta_{\rm D}(\vk-\vk_{12}) \vs
%&& \times\frac{\vk \cdot \vk_1}{k_1^2}{\theta}(\vk_1,\tau){\delta}(\vk_2,\tau) \eql{fouriercont}\\
%\frac{\partial{\delta}}{\partial\tau}+\frac{da}{d\tau}\frac{{\theta}}{a}+\frac{6}{\tau^2}{\delta}&=&-\int \frac{d^{3}\vk_{1}}{(2\pi)^3} \int \frac{d^{3}\vk_{2}}{(2\pi)^3} (2\pi)^3 \delta_{\rm D}(\vk-\vk_{12})\vs
%&&\times \frac{k^2(\vk_1 \cdot \vk_2)}{2k_1^2 k_2^2} {\theta}(\vk_1,\tau){\theta}(\vk_2,\tau) \eql{fouriereuler}
%\eea
%here $\vk_{12}=\vk_1 +\vk_2$ and more generally $\vk_{1\cdots n}=\vk_1 + \cdots +\vk_n$; $\theta\equiv \vec{\nabla}\cdot \vec{v}$ is the divergence of velocity field.\\
%In Einstein-de Sitter space, linear growth function $D_{1}(a)=a$ and we can solve these equations perturbatively using expansion:
%\bea
%{\delta}(\vk,\tau)&=&\sum_{n=1}^{\infty} {\delta}^{(n)}(\vk,\tau)=\sum_{n=1}^{\infty}a^{n}(\tau)\delta_{n}(\vk) \\ {\theta}(\vk,\tau)&=&\sum_{n=1}^{\infty}{\theta}^{(n)}(\vk,\tau)=-H(\tau)%\sum_{n=1}^{\infty}a^{n+1}(\tau)\theta_{n}(\vk) 
%\eea
%\\where the superscript $(n)$ means the order of perturbation theory, and first order term ${\delta}^{(1)}$ corresponds to linear evolution. Linear power spectrum is given by this first order term via:
%\be 
%\langle {\delta}(\vk){\delta}(\vk') \rangle =(2\pi)^3 \delta_{\rm D}(\vk+\vk')P_{\rm lin}(k) \eql{lin}
%\ee 
%Substituting the two perturbative series into \ec{fouriercont} and \ec{fouriereuler} we get recursion relations for ${\delta}_{n}(\vk)$ and ${\theta}_{n}(\vk)$ with solution:
%\bea
%{\delta}_{n}(\vk) &=& \int \frac{d^{3}\vk_{1}}{(2\pi)^3} \cdots \int \frac{d^{3}\vk_{n}}{(2\pi)^3}(2\pi)^3 \delta_{\rm D} (\vk-\vk_{1\cdots n}) \vs
%&&\times F_{n}(\vk_1,\cdots,\vk_n){\delta}_1(\vk_{1}) \cdots {\delta}_1(\vk_{n}) \\
%{\theta}_{n}(\vk) &=& \int \frac{d^{3}\vk_{1}}{(2\pi)^3} \cdots \int \frac{d^{3}\vk_{n}}{(2\pi)^3}(2\pi)^3 \delta_{\rm D} (\vk-\vk_{1\cdots n}) \vs
%&&\times G_{n}(\vk_1,\cdots,\vk_n){\delta}_1(\vk_{1}) \cdots {\delta}_1(\vk_{n})
%\eea
%and recursion relations are encoded in kernels $F_n$ and $G_n$. Since we only consider up to second-order, the second-order symmetrized kernels are given by:
%\bea 
%F_{2}(\vk_1,\vk_2)=\frac{5}{7}+\frac{2}{7}\frac{(\vk_1\cdot \vk_2)^2}{k_1^2 k_2^2}+\frac{\vk_1\cdot \vk_2}{2k_1k_2}(\frac{k_1}{k_2}+\frac{k_2}{k_1}) \\
%G_{2}(\vk_1,\vk_2)=\frac{3}{7}+\frac{4}{7}\frac{(\vk_1\cdot \vk_2)^2}{k_1^2 k_2^2}+\frac{\vk_1\cdot \vk_2}{2k_1k_2}(\frac{k_1}{k_2}+\frac{k_2}{k_1})
%\eea 
%This approach gives a nearly accurate description of $\Lambda$CDM universe \cite{Takahashi:2008to} with slight generalization \cite{Bernardeau:2002rev}:
%\bea
%{\delta}(\vk,\tau) &=&\sum_{n=1}^{\infty} {\delta}^{(n)}(\vk,\tau)=\sum_{n=1}^{\infty}D_1^{n}(\tau)\delta_{n}(\vk) \\
%{\theta}(\vk,\tau)&=&\sum_{n=1}^{\infty}{\theta}^{(n)}(\vk,\tau)\vs
%&=&-\frac{d\,\ln D_1(\tau)}{d\tau}\sum_{n=1}^{\infty}D_1^{n}(\tau)\theta_{n}(\vk) 
%\eea
%Time-dependent second-order density contrast can be expressed as convolution of two linear density fields with kernel $F_2$:
%\be 
%{\delta}^{(2)}(\vk,\tau)=\int \frac{d^{3}\vk_{1}}{(2\pi)^3} F_2(\vk_1,\vk-\vk_1){\delta}^{(1)}(\vk_1,\tau) {\delta}^{(1)}(\vk-\vk_1,\tau) \eql{sorder}
%\ee 

\section{Quadratic Estimator}\label{sec2}
In this section we construct the quadratic estimator for long-wavelength modes starting from \ec{2pt}. Then we forecast the detectability of the quadratic estimator for future surveys. Similar to CMB lensing's construction, we can write the general form of the estimator by averaging over pairs of the short-wavelength modes:
\begin{eqnarray}
\hat{\delta}^{(1)}(\vec{k}_l)=A(\vec{k}_l)\int \frac{d^3 \vec{k}_s}{(2\pi)^3} g(\vec{k}_s,\vec{k}_s'){\delta}(\vec{k}_s){\delta}(\vec{k}_s') \eql{quadest}
\end{eqnarray} 
with $g$ being weighting function, $\vk_s'=\vk_l-\vk_s$ and $A$ is defined by requiring $\langle \hat{\delta}^{(1)}(\vec{k}_l) \rangle={\delta}^{(1)}(\vec{k}_l)$:
\begin{eqnarray}
A(\vec{k}_l)=\bigg[\int \frac{d^3 \vec{k}_s}{(2\pi)^3} g(\vec{k}_s,\vec{k}_s')f(\vec{k}_s,\vec{k}_s')  \bigg]^{-1} \eql{a}
\end{eqnarray}
In the absence of shot noise the Gaussian noise is given by:
\be 
\langle \hat{\delta}^{(1)}(\vk_{l})\hat{\delta}^{(1)}(\vk_{l}') \rangle = (2\pi)^3 \delta_{\rm D}(\vk_{l}-\vk_{l}')[P_{\rm lin}(k_{l})+N(\vk_l)]
\ee 
with 
\begin{eqnarray}
&&N(\vec{k}_{l})=2A^2(\vk_{l})\vs
&&\times\int \frac{d^3 \vec{k}_{s}}{(2\pi)^3} g^2(\vec{k}_{s},\vk_l-\vec{k}_{s})P_{\rm nl}(k_{s})P_{\rm nl}(|\vk_l-\vk_s|)
\end{eqnarray}
where $P_{\rm nl}$ is the nonlinear power spectrum. Minimizing the noise term we can fix the form of $g$ to be:
\begin{eqnarray}
g(\vec{k}_{s},\vec{k}_{s}')=\frac{f(\vec{k}_{s},\vec{k}_{s}')}{2P_{\rm nl}(k_{s})P_{\rm nl}(k_{s}')}
\end{eqnarray} 
Noise term reduces simply to $N(\vk_l)=A(\vk_l)$. We test that the value of $N$ is very insensitive to the choice of the lower limit of the integration \ec{a} since most of the contribution comes from large $k_s$. We will discuss the choice of the upper limit later in section \ref{sec3}.\\
Assuming the noise is Gaussian, the projected detectability of $P(k_l)$ measurement from the quadratic estimator can be expressed as:
\be
\frac{1}{\sigma^{2}(k_l)}=\frac{V k_l^2 \Delta k }{(2\pi)^2}\bigg[\frac{P_{\rm lin}(k_l)}{P_{\rm lin}(k_l)+N(k_l) }\bigg]^2 \eql{error}
\ee
here $V$ is the volume of a survey and we can compute the detectability for a set of narrow $k_l$-bins each separated by width $\Delta k$.
\Sfig{SN}{Long-wavelength power spectrum and its error from \ec{error} which can be expressed as $P(k_l)\sigma(k_l)$. We assume a toy survey of boxsize $L=6\, \rm Gpc$, thus volume $V=L^3$ and width $\Delta k = 2\pi/L$. Moreover, we set the integration range for $\vk_s$ from $0.02 \, \rm Mpc^{-1}$ to $0.15\,\rm Mpc^{-1}$. We will see in the next section \ref{sec3} that this choice of the upper limit of integration is very reasonable for our current construction at $z=0$.}

\section{Demonstration with N-Body Simulation}\label{sec3}
We test the power of the quadratic estimator using snapshot at $z=0$ data of BigMPDL, one of the MultiDark cosmological simulations \cite{Klypin:2014nov}. Boxsize of BigMDPL is $3.7\,\rm Gpc$. We use dark matter particle data to produce matter inhomogeneities. Galaxy bias \cite{Desjacques:2018rev} should be otherwise considered if galaxy or halo catalog is used.\\
We use nbodykit code to get Fourier density modes \cite{Hand:2018nby} and compare $\delta(\vk_l)$ with $\hat{\delta}(\vk_l)$ for a 3D grid of $\vk_l$ in Fig.~\rf{hist}. $\delta(\vk_l)$ are the long-wavelength modes we get directly from N-body simulation and $\hat{\delta}(\vk_l)$ are the reproduced modes using quadratic estimator \ec{quadest}.\\
\Sfig{hist}{Histogram of number counts of $|\hat{\delta}(\vk_l)/\delta(\vk_l)|$ in Fourier space with different integration range of $k_s$. We can see that in the weakly nonlinear regime, left plot peaks at $1$ which is what we would expect. While for the right plot, when we go higher into nonlinear scale, ratio peak at about $1.3$. This bias comes from the inaccuracy of second-order perturbation theory.}
Ultimate goal of this approach is to reproduce large scale structure in real space. Compare $\delta$ and $\hat{\delta}$ in real space in Fig.~\rf{real} and we can check the robustness of the quadratic estimator for this simulation.
\Sfigg{real}{Comparison between $\delta(\vec{x})$ and $\hat{\delta}(\vec{x})$ and their difference. The 3D grid of data points are unfolded into 2D grids, $7$ columns corresponds to $7$ slices we have. The upper limit of $\vk_s$ is chosen to be $0.15 \, \rm Mpc^{-1}$. We can compute the signal-to-noise ratio as: $S/N=\Var(\delta)/\Var(\hat{\delta}-\delta)\approx 3$.\peikai{comment?}}

\section{Conclusion}\label{sec4}
In this paper, we have proposed a new and powerful method to measure long-wavelength modes without having to actually measure large scale structure directly. The noise term $N=A$ would reduce significantly if we go higher into nonlinear regime while second-order SPT is no longer accurate in this case. Thus if we want to detect even larger scales, we might need to use contributions from higher order perturbations and expand the integration range to reduce noise level. \\
Another concern is the range of long-wavelength modes we are able to detect. In the N-body simulation, we use $k_l$ from largest possible mode $1.7 \times 10^{-3} \, \rm Mpc^{-1}$ to $8.9\times 10^{-3} \, \rm Mpc^{-1}$. If we try to measure smaller modes, the quadratic estimator approach would be inaccurate since the contraction \ec{contraction} is no longer valid in this case.\\
Our current formalism of the quadratic estimator for long-wavelength modes in this paper is only valid in a box at a given cosmological time. While in photometric redshift surveys we would deal with light cones instead of boxes. Thus we expect the expression for the quadratic estimator to be generalized for photometric surveys. Moreover, we notice that the upper limit of integration range should also increase if we consider higher redshift, in order to include more nonlinear information. When applied to halos or galaxies, this approach should be modified to include galaxy bias. We leave these to future work.\\
\\ \\ \\ \\

\acknowledgements
\noindent We thank Adam Solomon, Duncan Campbell, Fabian Schmidt and Lam Hui for resourceful discussions.  SD, PL and RC were supported by U.S.\ Dept.\ of Energy contract DE-SC0019248.\\
The BigMDPL simulation has been performed at LRZ Munich within the PRACE project pr86bu. The CosmoSim database (\url{www.cosmosim.org}) providing the file access is a service by the Leibniz-Institute for Astrophysics Potsdam (AIP).
%\input{main.bbl}
\bibliography{refs}
\end{document}